<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>管理员帐户管理</title>
<link rel="stylesheet" href="m/admin_common.css" />
<script>function idf(id){return document.getElementById(id);};function xmlhttpxmlhttp(){this.new2=function(){return document.all?_IE_xmlhttp():_FF_xmlhttp();}};_IE_xmlhttp.prototype = new xmlhttpxmlhttp;function _IE_xmlhttp(){var xmlhttp=null;try{xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");}catch (e){try{xmlhttp= new ActiveXObject("Msxml2.XMLHTTP");}catch (err){return xmlhttp;}}return xmlhttp;}_FF_xmlhttp.prototype  = new xmlhttpxmlhttp; function _FF_xmlhttp(){var xmlhttp=null; xmlhttp= new XMLHttpRequest();if (!xmlhttp)return null;return xmlhttp; }
function edit_user_pass(id)
{
	var xml= new xmlhttpxmlhttp().new2();
	xml.open('GET',"/m.php?act=user_pass_edit&user_id="+id+"&t="+Math.random(), true);
	xml.onreadystatechange =function(){if (xml.readyState==4 && xml.status==200){idf('edit_pl').innerHTML=xml.responseText;idf('new_pass').focus();}	}
	xml.send(null);
}
</script>
</head>

<body>
<!-- 弹出层 -->
<style type="text/css">#layDic{background:#000;opacity:0.5;-moz-opacity:0.5;filter:alpha(opacity=45);position:absolute;top:0;left:0;z-index:998; display:none}.pop{position:absolute;z-index:999;background:#fff;border:6px solid #4481d5;text-align:center;display:none;font-size:12px;  margin-top:20px;}.popTp{line-height:22px;height:22px;overflow:hidden;zoom:1;color:#333; margin-right:5px; }</style><script type="text/javascript">function lightBox(popId,width,height,url){	this.popOBj=document.getElementById(popId);	this.layDic=document.getElementById("layDic");this.width=width;this.height=height;this.url=url;}lightBox.prototype={ run:function(){	try{var ph=parent.document.documentElement.scrollTop}catch(e){var ph=0;};window.open(this.url+'&t='+Math.random( ),'popTp_frame');document.getElementById('popTp_frame').height=this.height-30;this.layDic.style.width = Math.max(document.body.scrollWidth, document.body.clientWidth) + "px";this.layDic.style.height = Math.max(document.documentElement.scrollHeight, document.documentElement.clientHeight) + "px";this.popOBj.style.height=this.height+"px";this.popOBj.style.width=this.width+"px";this.popOBj.style.top=ph+document.documentElement.scrollTop+20+"px";this.popOBj.style.left=(document.documentElement.clientWidth-this.width)/2+"px";this.layDic.style.display="block";this.popOBj.style.display="block";},closeFun:function(){this.layDic.style.display="none";this.popOBj.style.display="none";}};var lightBox1;</script><div class="pop" id="popId" style="display:none" ><div class="popTp"></div><iframe name="popTp_frame" id="popTp_frame"  style="z-index:999" src="" frameborder="0" marginheight="0"  marginwidth="0" width="100%" ></iframe></div><div id="layDic" style="display:none"></div>
<!-- //弹出层 -->

<!--warpper-->
<div id="warpper">
<!--container-->
<div id="container">
<!--areaone-->
   	<div class="areaone">

<form action="m.php?act=user_add_do" method="post" name="user_add_do" id="user_add_do">
  <table width="100%" border="1" cellspacing="0" cellpadding="2">
  <tr class="trheader">
    <td height="32" colspan="2">添加新帐户</td>
    </tr>
  <tr>
    <td width="20%" height="32">帐户名称</td>
    <td><input name="user_name" type="text" id="user_name" value="<?=$_POST['user_name']?>" size="60" /></td>
  </tr>
  <tr>
    <td height="32">密码</td>
    <td><input name="user_pass" type="password" id="user_pass" value="<?=$_POST['user_pass']?>" size="60" /></td>
  </tr>
  <tr>
    <td height="32">确认密码</td>
    <td><input name="user_pass2" type="password" id="user_pass2" value="<?=$_POST['user_pass']?>" size="60" maxlength="200" /></td>
  </tr>
  <tr>
    <td height="32">备注</td>
    <td><textarea name="user_note" cols="60" rows="8" id="user_note"><?=$_POST['user_note']?></textarea></td>
  </tr>
  <tr>
    <td height="32">&nbsp;</td>
    <td><input type="submit" name="Submit" value="提交" /></td>
  </tr>
</table>
</form><br />

<div id="edit_pl"></div>

<form action="m.php?act=user_search_do" method="post" name="user_search_do" id="user_search_do">
  <table width="100%" border="1" cellspacing="0" cellpadding="2">
  <tr class="trheader">
    <td height="32" colspan="2">搜索帐户</td>
    </tr>
  <tr>
    <td width="20%" height="32">帐户名</td>
    <td><input name="user_name" type="text" id="user_name" value="<?=$_REQUEST['user_name']?>" size="40" /></td>
  </tr>
  <tr>
    <td height="32">&nbsp;</td>
    <td><input type="submit" name="Submit2" value="提交" /></td>
  </tr>
</table></form>

<br />

<table width="100%" border="1" cellspacing="0" cellpadding="2">
  <tr  class="trheader">
    <td height="32" colspan="3">帐户列表</td>
    </tr>
<?foreach($this->all_data['帐户'] as $v){?>	
  <tr onclick="cb(this)">
    <td height="32"><?=$v['user_id']?>/<?=$v['user_name']?>/<?=$v['user_note']?>/最后一次登陆:<?=$v['user_last_time_show']?>&nbsp;/<a  href="javascript:edit_user_pass(<?=$v['user_id']?>)">修改密码</a>/<a href="m.php?act=user_delete_do&user_id=<?=$v['user_id']?>" onclick="if(!confirm('确认删除?'))return false;">删除</a></td>
    <td><a href="javascript:void(0)" onclick="lightBox1=new lightBox('popId',700,500,'m.php?act=user_role&user_id=<?=$v['user_id']?>');lightBox1.run();">拥有角色</a>[<?foreach($v['角色'] as $vv){?><?=$vv['role_id']?>:<?=$vv['role_name']?>&nbsp;<?}?>]</td>
    <td><a href="javascript:void(0)"  onclick="lightBox1=new lightBox('popId',700,500,'m.php?act=user_tree&user_id=<?=$v['user_id']?>');lightBox1.run();" >导航菜单预览</a></td>
  </tr>
<?}?>  
  <tr>
    <td height="32" colspan="3"><?=$this->pageObj->show();?>&nbsp;</td>
    </tr>
</table>

	


	</div>
<!--//areaone -->
</div>
<!--//container -->
</div>   
<!--//warpper -->

<SCRIPT>function cb(divObj) { try  {if(divObj.clickMarkBGColor!=null){divObj.style.backgroundColor=divObj.clickMarkBGColor;divObj.clickMarkBGColor=null;}else{divObj.clickMarkBGColor=divObj.style.backgroundColor;divObj.style.backgroundColor='rgb(212,229,251)';} }catch(e){alert(e['message'])}}</SCRIPT>
	
</body>
</html>

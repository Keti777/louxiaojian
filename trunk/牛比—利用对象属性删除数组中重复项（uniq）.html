<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>删除数组中重复项（uniq） </title>
<style type="text/css">
*{margin:0; padding:0}
body{font:14px/1.5 Tahoma, Geneva, sans-serif; padding:0 50px}
.code-switch{font-family:"Courier New", Courier, monospace; border-left:2px solid #eee; padding:0 10px; line-height:15px;margin-bottom:20px;color:#09F}
</style>
</head>

<body>
from <a href="http://www.planabc.net/2009/12/26/array_uniq" target="_blank">http://www.planabc.net/2009/12/26/array_uniq</a>
<br />
请用对象属性 来删除 数组中重复项
<script type="text/javascript">
var uniq = function (arr) 
{    
	var a = [],
	o = {},
	i,
	v,
	len = arr.length;
	if (len < 2) {return arr;}
	for (i = 0; i < len; i++)
		{
			v = arr[i];
			if (o[v] !== 1) /*如果对象中不存在此属性时，此把此元素添加到新数组中去*/
			{
			  a.push(v);  
			  o[v] = 1; 
		    } 
	}
	return a;
}
</script>
<pre class="code-switch"></pre>
以上函数方法暂时都不能处理复杂的含有混合类型的数组（感谢 小猫 提出的疑问），如：[0,"0",1,"1",0]、["null",null]。
<script type="text/javascript">
  (function(){
    var date=new Date();
	for(var i=0;i<10000;i++){
  var lxj=[1,2,3,4,5,1]
  var j=uniq(lxj);
	}
  var a=new Date()-date;
  document.write('<br />所用时间:'+a);
  var lxj2=[0,"0",1,"1",0]
  var j2=uniq(lxj2);
  document.write('<br/><br/>[1,2,3,4,5,1]运行后得到==='+'['+j+']');
  document.write('<br/><br/>[0,"0",1,"1",0]运行后得到==='+'['+j2+']'+'这里就不正确了');
  })()
</script>
 <p>改进后的方法</p>
<script type="text/javascript">
  var uniq2 = function (arr) {
	  var a = [],
		  o = {},
		  i,
		  v,
		  cv, // corrected value
		  len = arr.length;
  
	  if (len < 2) {
		  return arr;
	  }
  
	  for (i = 0; i < len; i++) {
		  v = arr[i];
  
		  /* closurecache 提供的函数中使用的是  cv = v + 0;，
		   * 这样就无法辨别类似[1, 10, "1", "10"]的数组，
		   * 因为运算后 => 1, 10, 10, 100，很明显，出现了重复的标示符。
		   * 加前面就难道没问题吗？
		   * 有的：数组中不能出现类似01 、001，以 0 开头的数字，
		   * 但适用性比原先更广。
		   */
		  cv = 0 + v;
  
		  if (!o[cv]) {
			  a.push(v);
			  o[cv] = true;
		  }
	  }
  
	  return a;
  }
</script>
<pre class="code-switch"></pre>
<p>例子</p>
<script type="text/javascript">
(function(){
  var lxj=[1,2,3,4,5,1]
  var j=uniq2(lxj);
  
  var lxj2=[0,"0",1,"1",0]
  var j2=uniq2(lxj2);
  document.write('<br/><br/>[1,2,3,4,5,1]运行后得到==='+'['+j+']');
  document.write('<br/><br/>[0,"0",1,"1",0]运行后得到==='+'['+j2+']'+'这里就不正确了');
})()
</script>
<script type="text/javascript">
var Lou={};
function getElementsByClassName(node, name, type) {
		if (node.getElementsByClassName)
			return node.getElementsByClassName(name);
			else {
			var r = [], re = new RegExp("(^|\\s)" + name + "(\\s|$)"), e = (node || document).getElementsByTagName(type || "*");
			for ( var i = 0; i < e.length; i++ ) {
				if( re.test(e[i].className) )
					r.push(e[i]);
			}
			return r;
		}
	}
Lou['getElementsByClassName']=getElementsByClassName;
function cleanWhitespace(oEelement)
{
 for(var i=0;i<oEelement.childNodes.length;i++){
  var node=oEelement.childNodes[i];
  if(node.nodeType==3 && !/\S/.test(node.nodeValue)){node.parentNode.removeChild(node)}
  }
}
Lou['cleanWhitespace']=cleanWhitespace;

Lou.cleanWhitespace(document.body)
var code=Lou.getElementsByClassName(document,'code-switch','pre')
for(var i=0;i<code.length;i++){
	code[i].innerHTML=code[i].previousSibling.innerHTML;
	
}
</script>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>弹出框js</title>
</head>

<body>
<div id="lxj" style="background:#fff; position:absolute;font-size:14px; line-height:50px">123456789<a href="#" onclick="return false" class="p_close">关闭一</a><a href="#" onclick="return false" class="p_close">关闭二</a></div>
<script type="text/javascript">
function dialog(set){
	  this.sets(set);
	  this.dialog=this.$(this.boxSet.id);
	  this.openBack=this.boxSet.openBack;
	  this.closeBack=this.boxSet.closeBack;
	  this.top=parseInt(this.boxSet.top);
	  this.left=parseInt(this.boxSet.left);
	  this.Layer=this.boxSet.Layer
	  this.fix=this.boxSet.fix;
	  this.dialogInit();
	  this.open();
	  window.onresize=this.B(this,this.setPosition);
};
dialog.close=function(){
	        var layDic=document.getElementById('layDic'),dialog=document.getElementById('dialog');
			if(layDic){layDic.style.display="none";layDic.parentNode.removeChild(layDic)}
			dialog.style.display="none";
			if(document.all && ([/MSIE (\d)\.0/i.exec(navigator.userAgent)][0][1] == 6)){
				selects = document.getElementsByTagName("select");
				for(i = 0; i < selects.length; i++) {selects[i].style.visibility = 'visible';}
			}
}
dialog.prototype={
	  $:function(id){return "string" == typeof id ? document.getElementById(id) : id;},
	  isIE6:document.all && ([/MSIE (\d)\.0/i.exec(navigator.userAgent)][0][1] == 6),
	  B:function(object, fun) {
		var args = Array.prototype.slice.call(arguments).slice(2);
		return function() {
			return fun.apply(object, args);
		}
	   },
	  Extend:function(destination, source) {
		  for (var property in source) {
			  destination[property] = source[property];
		  }
	  },
	  getECN:function(node, name, type) {
			  var r = [], re = new RegExp("(^|\\s)" + name + "(\\s|$)"), e = (node || document).getElementsByTagName(type || "*");
			  for ( var i = 0,len=e.length; i < len; i++ ) {
				  if(re.test(e[i].className) )
					  r.push(e[i]);
			  }
			  return r;
	  },
	  sets:function(s){
		  this.boxSet={
			  Layer:1,
			  width:"",
			  height:"",
			  left:'undefind',
			  top:'undefind',
			  fix:0,
			  openBack:function(){},
			  closeBack:function(){},
			  closeName:'p_close'
		  };
		  this.Extend(this.boxSet, s || {});
	  },
	  shadingLayer:function(){
		      if(!document.getElementById('layDic')){
				  this.layDic=document.createElement("div");
				  this.layDic.setAttribute('id','layDic');
				  this.layDic.style.cssText="opacity:0.5;-moz-opacity:0.5;filter:alpha(opacity=50);background:#000;position:absolute;top:0;left:0;z-index:9998;display:none";
				  document.body.appendChild(this.layDic);
			  }else{
				  this.layDic=document.getElementById('layDic');
			  }
	  },
	  hideSelects: function(v){
			if(this.isIE6){
				selects = document.getElementsByTagName("select");
				for(i = 0; i < selects.length; i++) {selects[i].style.visibility = v;}
			}
	  },
	  dialogInit:function(){
			var closebut,_this=this;
			this.dialog.style.display="block";
			this.pHeight=this.boxSet.height ?  parseInt(this.boxSet.height) : this.dialog.offsetHeight;
			this.pWidth=parseInt(this.boxSet.width);
			this.dialog.style.width=this.pWidth+"px";
			this.dialog.style.zIndex=9999; 
			this.dialog.style.display="none";
			closebut=this.getECN(this.dialog,this.boxSet.closeName,'*');
			for(var i=0,len=closebut.length;i<len;i++){
				closebut[i].onclick=function(){_this.close.call(_this);return false;
				}
			}
	  },
	  fixed:function(){
		  var d=document,db=d.body,dd=d.documentElement;
		  if(this.isIE6){
			var top=this.top ? this.top : this.cTop;
			var expression=";top:expression(documentElement.scrollTop+"+top+");)"
			this.dialog.style.position='absolute';
			this.dialog.style.cssText+=expression;
			document.body.style.cssText+=';background:url(about:blank) fixed';
		  }else{
			this.dialog.style.position='fixed';
			this.dialog.style.top=this.top ? (this.top+'px') : this.cTop+"px";
		  }
		  return this;
	  },
	  unfixed:function(){
		  var d=document,db=d.body,dd=d.documentElement;
		  this.dialog.style.position="absolute";
		  this.dialog.style.top=this.top ? (this.top+'px') : (dd.scrollTop+this.cTop+"px");
	  },
	  setPosition:function(){
		  var d=document,db=d.body,dd=d.documentElement;
		  this.layDic.style.width = Math.max(db.scrollWidth, db.clientWidth) + dd.scrollLeft+"px";
		  this.layDic.style.height = Math.max(dd.scrollHeight, dd.clientHeight) + dd.scrollTop+"px";
		  this.cTop=(dd.clientHeight-this.pHeight)*0.382;
		  if(this.cTop<0) this.cTop=0;
          this.fix ? this.fixed() : this.unfixed();
		  this.dialog.style.left=this.left ? (this.left+'px') : ((dd.clientWidth-this.pWidth)/2+"px");
		  
	  },
	  open:function(){
		  if(this.Layer){this.shadingLayer();this.layDic.style.display="block";this.hideSelects("hidden")};
		  this.setPosition();
		  this.dialog.style.display="block";
		  this.openBack();
	  },
	  close:function(){
		if(this.Layer){this.layDic.style.display="none";this.layDic.parentNode.removeChild(this.layDic);this.hideSelects("visible")}
		this.dialog.style.display="none";
		this.closeBack();
	  }


};
//new dialog({id:'playHistory_float',width:178})
//dialog end

new dialog({id:'lxj',width:350})
</script>
</body>
</html>

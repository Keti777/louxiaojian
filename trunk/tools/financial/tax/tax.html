<!doctype html>
<html>
<head>
    <meta charset="gbk"/>
    <title>新个税计算器</title>
    <style type="text/css">
        *{margin:0;padding:0}
        body{font-size:14px}
        .input{border:1px solid #ccc;font-size:18px;color:#f00;font-weight:bold;height:24px;width:200px;vertical-align:top;}
        .from-item{line-height:26px;padding-bottom:10px;overflow:hidden;zoom:1}
		.from-item label,.from-item .input{float:left}
		.from-item label{width:100px;text-align:right}
        .button{padding:4px 7px;margin-left:100px}
    </style>
	<script>
	function $(id){
	  return typeof(id)=='string' ? document.getElementById(id) : id
	}
	</script>
</head>
<body>

<div style="width:500px;margin:0 auto;padding:10px">
    <div class="from-item"><label>薪水：</label><input type="text" id="xinshui" value="" class="input"></div>
    <div class="from-item"><label>公积金：</label><input type="text" id="gongjijin" value="1354" class="input"></div>
	<div class="from-item"><label>社保：</label><input type="text" id="shebao" value="1063.5" class="input"></div>
    <div class="from-item"><label>个税：</label><input type="text" id="test" value="" class="input"></div>
    <div class="from-item"><label>实发薪水：</label><input type="text" id="shifaxinshui" value="" class="input"></div>
    <input id="J_Button" type="button" class="button" value="计算"/>
</div>

<script>
(function(){
    window['chinaTax']={
        'begin':3500,
        'jb':[
            {level:1,income:'1-1500',tax:0.03,deduct:0},
            {level:2,income:'1500-4500',tax:0.1,deduct:105},
            {level:3,income:'4500-9000',tax:0.2,deduct:555},
            {level:4,income:'9000-35000',tax:0.25,deduct:1005},
            {level:5,income:'35000-55000',tax:0.3,deduct:2755},
            {level:6,income:'55000-80000',tax:0.35,deduct:5505},
            {level:7,income:'80000-above',tax:0.45,deduct:13505}
        ],
        'getLevel': function (value){
            var l,suanfa=this.jb;
            for(var i=0,ii=suanfa.length;i<ii;i++){
                var income;
                if(value>suanfa[ii-1].income.split('-')[0]){
                    l=suanfa[ii-1].level;
                    break;
                }
                income=suanfa[i].income.split('-');
                if(value>=income[0] && value<income[1] && value<suanfa[6].income.split('-')[0]){
                    l=suanfa[i].level;
                    break;
                }
            }
            return l;
        },
        'getTax': function (value){
            var l=this.getLevel(value)-1,suanfa=this.jb;
            return value*suanfa[l].tax-suanfa[l].deduct;
        }
    };
	
	/**
	 * Removes the whitespace from the beginning and end of a string.
	 */
	//undef();
	function trim(str,undef){
	   var EMPTY = '',
		_trim = String.prototype.trim,
		RE_TRIM = /^\s+|\s+$/g,
		strtrim=_trim ?  ((str == undef) ? EMPTY : _trim.call(str)) : ((str == undef) ? EMPTY : str.toString().replace(RE_TRIM, EMPTY));
		return strtrim;
	};
	
	$('J_Button').onclick=function(){
		if(!trim($('xinshui').value)){
			alert('薪水不能为空');
			return false;
		}
		var xinshui=$('xinshui').value,gongjijin=$('gongjijin').value/2,shebao=$('shebao').value,
		    gesui=chinaTax.getTax(xinshui-chinaTax.begin-gongjijin-shebao),
		    shijixinshui=xinshui-gongjijin-shebao-gesui;
		    $('test').value=gesui;
		    $('shifaxinshui').value=shijixinshui;
		
	}
	
})();
</script>
</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>使用apache和htaccess对目录访问设置密码保护配置教程</title>
<style type="text/css">
*{margin:0; padding:0}
body{padding:20px 50px; font:14px/1.6 Tahoma, Geneva, sans-serif}
h2{font-size:16px;}
.bd{padding:10px 20px 20px}
.codecolorer{padding:10px 20px;margin:10px 0;border:1px solid #ddd}
</style>
</head>

<body>
<div class="content">
    <h1><strong>对目录设置密码保护配置说明</strong></h1>
    <p>在PHP网站开发中，如何保证网站的安全性是我们必须考虑的问题，之前介绍过通过apache配置文件对目录访问权限进行控制的方法，今天会以教程的形式向大家介绍如何使用apache和htaccess对相关目录进行密码保护配置，比如对网站管理后台目录访问进行密码保护，访问后台管理目录时必须使用合法用户名和密码才能访问。</p>
    <p>在继续往下学习时，如果你对apache htpasswd.exe命令不太熟悉，推荐你先查看相关的PHP教程。</p>
    
    
    <p>在本教程中主要介绍两种方法，一种是通过apache httpd.conf配置文件对管理后台目录设置密码保护，适用于具有服务器控制权限的用户，另一种是通过.htaccess配置文件对目录设置密码保护，适用于虚拟主机用户。</p>
    <h2><strong>apache httpd.conf配置文件对目录设置密码保护教程</strong></h2>
    <div class="bd">
        <p>1、使用apache htpasswd.exe创建密码文件
        <strong style="margin-left:50px; display:block">如何利用htpasswd命令添加用户？
        <br />htpasswd -bc .passwd seanlou 150701301
        <br />在bin目录下生成一个.passwd文件，用户名seanlou，密码：150701301，默认采用MD5加密方式</strong>
        </p>
        </p>
        <p>2、打开apache httpd.conf配置文件</p>
        <p>3、找到&lt;Directory&gt;&#8230;&lt;/Directory&gt;块，对test目录访问设置密码保护</p>
        
        <div class="text codecolorer" style="font-family:Monaco,Lucida Console,monospace">
        &lt;Directory E:/&gt;<br />
        AuthType Basic<br />
        AuthName &quot;SeanLou&quot;<br />
        AuthUserFile D:/ProgramFiles/apache/bin/user<br />
        Require user seanlou<br />
        &lt;/Directory&gt;
        </div>
        <p>4、保存apache httpd.conf，并重启apache服务器。</p>
        <p>上述配置只允许seanlou用户以正确的密码登陆才能访问leapsoul/test/目录</p>
        <p><strong>注意事项</strong></p>
        <p>1、设置密码保护的目录路径不要使用反斜杠，使用/</p>
        <p>2、密码文件引用需要使用绝对路径</p>
    </div>
    
    <h2><strong>使用.htaccess配置文件对目录设置密码保护教程</strong></h2>
    <div class="bd">
        <p>1、使用apache htpasswd.exe创建密码文件</p>
        <p>2、创建.htaccess配置文件，你可以使用EditPlus新建文件并保存为.htaccess配置文件</p>
        <p>3、在.htaccess配置文件中的写入配置信息，.htaccess配置文件的写法与apache配置文件有所不同，没有Directory</p>
        <div class="text codecolorer" style="font-family:Monaco,Lucida Console,monospace">AuthType Basic<br />
        AuthName &quot;seanlou&quot;<br />
        AuthUserFile D:/ProgramFiles/apache/bin/user<br />
        Require user seanlou</div>
        <p>4、保存.htaccess配置文件，并将.htaccess配置文件放置在需要设置密码保护的目录下，比如leapsoul/test/目录</p>
        <p>上述.htaccess配置功能与第一种方法实现的功能是一样的。</p>
        <p>你也可以在浏览器的URL框内以以下方式输入用户名和密码（未加密的）来直接进行访问：</p>
        <div class="text codecolorer" style="font-family:Monaco,Lucida Console,monospace">http://username:password@www.yourwebsite.com/directory/</div>
    </div>
    
    <h2><strong>.htaccess配置注意事项</strong></h2>
    <div class="bd">
        <p>如何开启.htaccess配置功能？</p>
        <p>除了和apache httpd.conf配置一样需要注意的那些问题之外，容易出现的一个错误是如果配置不正确，会出现.htaccess配置文件不起作用的问题，这是因为apache?AllowOverride指令，决定了你的.htaccess是否能正常开启并启用。从安全性考虑，apache httpd.conf配置文件中网站根目录的AllowOverride属性一般都配置成不允许任何Override ，即</p>
        
        <div class="text codecolorer" style="font-family:Monaco,Lucida Console,monospace">&lt;Directory /&gt;<br />
        AllowOverride None<br />
        &lt;/Directory&gt;
        </div>
        <p>当AllowOverride 设置为 None 时，.htaccess 文件将被完全忽略。当此指令设置为 All 时，所有具有 “.htaccess” 作用域的指令都允许出现在 .htaccess 文件中。所以要使apache能够正常的读取.htaccess文件的内容，开启.htaccess功能，使.htaccess配置文件中的设置起作用，就必须对网站根目录或者.htaccess 所在目录进行配置，将AllowOverride None更改为AllowOverride All。</p>
        <p>如果你是虚拟主机用户在使用.htaccess配置文件对目录设置密码保护时，请咨询你的主机商是否允许启用.htaccess，并告知网站目录的绝对路径。</p>
    </div>
    
    <h2><strong>apache和.htaccess配置选项说明</strong></h2>
    <div class="bd">
        <p>AuthName － 浏览器弹出登录框时显示的被保护的名字，可自行改动。</p>
        <p>AuthType Basic － 认证的类型。</p>
        <p>AuthUserFile － 指向apache htpasswd.exe生成的密码文件，必须是绝对路径</p>
        <p>Require － 设置可以对被保护目录进行访问的用户。</p>
        <p>require valid-user －就是指在 .passwd 中的任何一位用户都可以访问。</p>
        <p>require user username 或 require user username1 username2 username3 －?指定.passwd中的特定的用户可以访问被保护的目录。</p>
        <p>require group groupname － 指定用户组来访问被保护目录。</p>
        <p>设置组的方法是再创建一个.htgroup配置文件：</p>
        <p>groupname1: username1 username2 username3</p>
        <p>groupname2: username1 username3 username4</p>
        <p>再在apache httpd.conf配置文件或者.htaccess配置文件中添加：</p>
        <p>AuthGroupFile C:/.htgroup</p>
    </div>
    
    <h2><strong>使用apache和htaccess对目录访问设置密码保护的效果</strong></h2>
    <div class="bd">
        <div id="attachment_579" class="wp-caption aligncenter" style="width: 340px">
        <img class="size-full wp-image-579" title="使用apache和htaccess对目录访问设置密码保护" src="htaccess-password.jpg" alt="使用apache和htaccess对目录访问设置密码保护"/>
        </div>
    </div>

</div>
        
</body>
</html>

<!doctype html>
<html>
<head>
    <meta charset="gbk"/>
    <title>copyToClipboard</title>
</head>
<body>
<div>
<textarea id="test" style="width:300px;height:200px">http://v.pps.tv/play_10DK5Y.html</textarea>
<embed width="61" height="21" id="highlighter_872611_clipboard" type="application/x-shockwave-flash" title="复制代码" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=test" menu="false" src="clipboard.swf">


<p>针对ie浏览器</p>
<object id="highlighter_768879_clipboard" title="copy to clipboard" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" type="application/x-shockwave-flash" height="160" width="160" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">
    <param value="always" name="allowscriptaccess" />
    <param value="transparent" name="wmode" />
    <param value="highlighterid=test" name="flashvars" />
    <param value="false" name="menu" />
    <param value="clipboard.swf" name="movie" />
</object>

    <script>
    var SyntaxHighlighter={};
    SyntaxHighlighter.toolbar={};
    SyntaxHighlighter.toolbar.executeCommand=function(sender, event, highlighterId, commandName, args)
    {
//        alert(highlighterId);
        var clipboardValue=document.getElementById('test').value || 'flash复制测试',command = args.command,
        execute={
            'get':function(){
                return clipboardValue;
            },
            'ok':function(){
                alert('复制成功')
            },
            'error':function(){
                alert('复制失败')
            }
        };
        return execute[command]();
    };
</script>
</div>
</body>
</html>